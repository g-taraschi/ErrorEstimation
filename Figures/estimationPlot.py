import numpy as np
import matplotlib.pyplot as plt

# h-ref H1
data = np.array([
[9, 2.106e+00, 1.730e+00, 1.217e+00],
[25, 9.171e-01, 8.689e-01, 1.055e+00],
[81, 4.418e-01, 4.357e-01, 1.014e+00],
[289, 2.188e-01, 2.180e-01, 1.003e+00],
[1089, 1.091e-01, 1.090e-01, 1.001e+00],
[4225, 5.453e-02, 5.452e-02, 1.000e+00],
])

# h-ref Mixed
data = np.array([
[56, 2.161e+00, 1.709e+00, 1.265e+00],
[208, 9.218e-01, 8.685e-01, 1.061e+00],
[800, 4.422e-01, 4.357e-01, 1.015e+00],
[3136, 2.188e-01, 2.180e-01, 1.004e+00],
[12416, 1.091e-01, 1.090e-01, 1.001e+00],
[49408, 5.453e-02, 5.452e-02, 1.000e+00]
])

# p-ref H1
data = np.array([
[25, 9.171e-01, 8.689e-01, 1.055e+00],
[81, 9.184e-02, 8.831e-02, 1.040e+00],
[169, 6.031e-03, 5.849e-03, 1.031e+00],
[289, 2.966e-04, 2.893e-04, 1.025e+00],
[441, 1.166e-05, 1.142e-05, 1.022e+00],
[625, 3.821e-07, 3.751e-07, 1.019e+00]
])

# p-ref Mixed
data = np.array([
[208, 9.218e-01, 8.685e-01, 1.061e+00],
[456, 1.215e-01, 9.619e-02, 1.263e+00],
[800, 9.711e-03, 6.969e-03, 1.394e+00],
[1240, 5.570e-04, 3.727e-04, 1.495e+00],
[1776, 2.469e-05, 1.575e-05, 1.567e+00],
[2408, 8.917e-07, 5.498e-07, 1.622e+00]
])

# p-ref H1 16x16
data = np.array([
[289, 8.835e-01, 8.714e-01, 1.014e+00],
[1089, 4.465e-02, 4.421e-02, 1.010e+00],
[2401, 1.478e-03, 1.466e-03, 1.008e+00],
[4225, 3.650e-05, 3.627e-05, 1.006e+00],
[6561, 7.197e-07, 7.158e-07, 1.005e+00],
[9409, 1.182e-08, 1.176e-08, 1.005e+00],
])

# p-ref Mixed 16x16
data = np.array([
[3136, 8.845e-01, 8.714e-01, 1.015e+00],
[7008, 5.970e-02, 4.836e-02, 1.235e+00],
[12416, 2.420e-03, 1.751e-03, 1.382e+00],
[19360, 6.955e-05, 4.680e-05, 1.486e+00],
[27840, 1.543e-06, 9.887e-07, 1.561e+00],
[37856, 2.789e-08, 1.725e-08, 1.617e+00],
])

# h-ref H1 p=4
data = np.array([
[81, 5.035e-03, 4.570e-03, 1.102e+00],
[289, 2.966e-04, 2.893e-04, 1.025e+00],
[1089, 1.825e-05, 1.814e-05, 1.006e+00],
[4225, 1.136e-06, 1.134e-06, 1.002e+00],
[16641, 7.094e-08, 7.092e-08, 1.000e+00],
[66049, 4.438e-09, 4.438e-09, 1.000e+00],
])

# h-ref Mixed p=4
data = np.array([
[320, 8.952e-03, 5.852e-03, 1.530e+00],
[1240, 5.570e-04, 3.727e-04, 1.495e+00],
[4880, 3.478e-05, 2.340e-05, 1.486e+00],
[19360, 2.173e-06, 1.464e-06, 1.484e+00],
[77120, 1.358e-07, 9.155e-08, 1.483e+00],
[307840, 8.496e-09, 5.722e-09, 1.485e+00],
])

# h-ref H1 f=0
data = np.array([
[9, 2.106e+00, 1.730e+00, 1.217e+00],
[25, 9.171e-01, 8.689e-01, 1.055e+00],
[81, 4.418e-01, 4.357e-01, 1.014e+00],
[289, 2.188e-01, 2.180e-01, 1.003e+00],
[1089, 1.091e-01, 1.090e-01, 1.001e+00],
[4225, 5.453e-02, 5.452e-02, 1.000e+00],
])

# h-ref Mixed f=0
data = np.array([
[56, 2.161e+00, 1.709e+00, 1.265e+00],
[208, 9.218e-01, 8.685e-01, 1.061e+00],
[800, 4.422e-01, 4.357e-01, 1.015e+00],
[3136, 2.188e-01, 2.180e-01, 1.004e+00],
[12416, 1.091e-01, 1.090e-01, 1.001e+00],
[49408, 5.453e-02, 5.452e-02, 1.000e+00],
])

# p-ref H1 f=0
data = np.array([
[25, 9.171e-01, 8.689e-01, 1.055e+00],
[81, 9.184e-02, 8.831e-02, 1.040e+00],
[169, 6.031e-03, 5.849e-03, 1.031e+00],
[289, 2.966e-04, 2.893e-04, 1.025e+00],
[441, 1.166e-05, 1.142e-05, 1.022e+00],
[625, 3.821e-07, 3.751e-07, 1.019e+00],
])

# p-ref Mixed f=0
data = np.array([
[208, 9.218e-01, 8.685e-01, 1.061e+00],
[456, 1.215e-01, 9.619e-02, 1.263e+00],
[800, 9.711e-03, 6.969e-03, 1.394e+00],
[1240, 5.570e-04, 3.727e-04, 1.495e+00],
[1776, 2.469e-05, 1.575e-05, 1.567e+00],
[2408, 8.917e-07, 5.498e-07, 1.622e+00]
])

dofs = data[:, 0]
estimated_error = data[:, 1]
real_error = data[:, 2]

# Compute -log(dofs), log(estimated error), log(real error)
x = np.log(dofs)
y1 = np.log(estimated_error)
y2 = np.log(real_error)

plt.figure(figsize=(7,5))
plt.plot(x, y1, 'o-', label='log(Estimated Error)')
plt.plot(x, y2, 's--', label='log(Real Error)')
plt.xlabel('log(Degrees of Freedom)')
plt.ylabel('log(Error)')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig('est_Mixed_pref_f0.pdf')

# Second figure: log(dofs) vs effectivity index
plt.figure(figsize=(7,5))
plt.plot(np.log(dofs), data[:,3], 'o-', label='Effectivity Index')
plt.xlabel('log(Degrees of Freedom)')
plt.ylabel('Effectivity Index')
plt.grid(True)
plt.tight_layout()
plt.savefig('eff_Mixed_pref_f0.pdf')
